

parameters:
  notebook: 01_DataPrep.ipynb  # defaults for any parameters that aren't specified
  location: "{{cookiecutter.project_name}}"
  subscription: ""

steps:
  - task: AzureCLI@1
    displayName: '${{parameters.notebook}}'
    inputs:      
      azureSubscription: ${{parameters.subscription}}
      scriptLocation: inlineScript
      inlineScript: |
        source activate deployment_aml
        export PYTHONPATH=$(pwd)/{{cookiecutter.project_name}}/Keras_Tensorflow:${PYTHONPATH}
        cd ${{parameters.location}}
        echo Execute ${{parameters.notebook}}
        papermill ${{parameters.notebook}} output.ipynb \
          --log-output \
          --no-progress-bar \
          -k python3
        sleep 30
